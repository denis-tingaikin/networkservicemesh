---
executions:
  - name: "Interdomain suite tests gke-packet"
    env:
      - ARCHIVE_ARTIFACTS=true
      - ARTIFACTS_DIR=/home/circleci/project/.tests/cloud_test/$(cluster-name)/$(test-name)
      - FIXED_NAMESPACE=true
    source:
      tags:
        - interdomain_suite
    root: ./test/integration
    after-all: |
      make k8s-delete-nsm-namespaces
    timeout: 600
    cluster-count: 2
    cluster-selector:
      - gke
      - packet
    kubernetes-env:
      - KUBECONFIG_CLUSTER_1
      - KUBECONFIG_CLUSTER_2
    on-test-fail: |
      make k8s-delete-nsm-namespaces
  - name: "Interdomain suite tests azure-gke"
    env:
      - ARCHIVE_ARTIFACTS=true
      - ARTIFACTS_DIR=/home/circleci/project/.tests/cloud_test/$(cluster-name)/$(test-name)
      - FIXED_NAMESPACE=true
    source:
      tags:
        - interdomain_suite
    root: ./test/integration
    timeout: 600
    cluster-count: 2
    cluster-selector:
      - azure
      - gke
    kubernetes-env:
      - KUBECONFIG_CLUSTER_1
      - KUBECONFIG_CLUSTER_2
    after-all: |
      make k8s-delete-nsm-namespaces
    on-test-fail: |
      make k8s-delete-nsm-namespaces
  - name: "Interdomain suite tests aws-azure"
    env:
      - ARCHIVE_ARTIFACTS=true
      - ARTIFACTS_DIR=/home/circleci/project/.tests/cloud_test/$(cluster-name)/$(test-name)
      - FIXED_NAMESPACE=true
    source:
      tags:
        - interdomain_suite
    root: ./test/integration
    timeout: 600
    cluster-count: 2
    cluster-selector:
      - aws
      - azure
    kubernetes-env:
      - KUBECONFIG_CLUSTER_1
      - KUBECONFIG_CLUSTER_2
    after-all: |
      make k8s-delete-nsm-namespaces
    on-test-fail: |
      make k8s-delete-nsm-namespaces
